# æŠ€æœ¯æ”¯æŒç®¡ç†ç½‘ç«™

åŸºäºReact 18 + TypeScript + Viteçš„ç°ä»£åŒ–æŠ€æœ¯æ”¯æŒç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒè®¾å¤‡ç®¡ç†ã€æ‰“å°æœºç›‘æ§ã€ç»´æŠ¤è®°å½•ã€ä½ç½®è¿½è¸ªã€å•æ®åŒ–æ“ä½œã€ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ“± **è®¾å¤‡ç®¡ç†**: æ”¯æŒæ‰“å°æœºã€è·¯ç”±å™¨ã€ç‰©è”ç½‘å¡ç­‰è®¾å¤‡çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- ğŸ“Š **ç»Ÿè®¡çœ‹æ¿**: å®æ—¶è®¾å¤‡çŠ¶æ€ã€åº“å­˜æ°´å¹³ã€æ“ä½œè¶‹åŠ¿å¯è§†åŒ–å±•ç¤º
- ğŸ“‹ **å•æ®åŒ–æ“ä½œ**: æ‰€æœ‰è®¾å¤‡æ“ä½œé€šè¿‡äº‹åŠ¡åŒ–å•æ®ç³»ç»Ÿï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- ğŸ¯ **å‚æ•°åŒ–è°ƒåº¦**: å£°æ˜å¼é…ç½®è°ƒåº¦å‚æ•°ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œè”åŠ¨åŠ¨ä½œ
- ğŸ” **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œè®°å½•å’Œæ•°æ®å˜æ›´è¿½è¸ª
- ğŸ”§ **SOPæµç¨‹**: æ ‡å‡†æ“ä½œç¨‹åºæŒ‡å¯¼å’Œè¿›åº¦è·Ÿè¸ª
- ğŸ“¦ **åº“å­˜ç®¡ç†**: è€—æåº“å­˜ç›‘æ§ã€ä½åº“å­˜å‘Šè­¦ã€å…¼å®¹æ€§éªŒè¯
- ğŸš€ **å®‰è£…å‘å¯¼**: æ¨¡æ¿åŒ–è®¾å¤‡å®‰è£…æµç¨‹ï¼Œæ”¯æŒé¢„æ£€å’Œæ‰¹é‡æ“ä½œ

### ä¸šåŠ¡ç‰¹æ€§
- **å…¼å®¹æ€§æ£€æŸ¥**: DNPåªå…è®¸ä¸“ç ï¼Œè¯šç ”/è¥¿é“åŸæ”¯æŒä¸“ç é€šç äºŒé€‰ä¸€
- **ä¸“ç ç»‘å®š**: ç¡®ä¿ä¸“ç ä¸è®¾å¤‡çš„å”¯ä¸€ç»‘å®šå…³ç³»
- **åº“å­˜è”åŠ¨**: å®æ—¶åº“å­˜ä½™é¢è®¡ç®—å’Œå˜æ›´è®°å½•
- **ä½ç½®è¿½è¸ª**: è®¾å¤‡ä½ç½®å˜æ›´å†å²å’Œå½“å‰çŠ¶æ€
- **ç»´æŠ¤è®°å½•**: è®¾å¤‡ç»´æŠ¤å†å²å’Œè®¡åˆ’ç®¡ç†

## ğŸ›  æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: React 18 + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **æ ·å¼ç³»ç»Ÿ**: TailwindCSS + shadcn/ui
- **çŠ¶æ€ç®¡ç†**: @tanstack/react-query
- **è·¯ç”±ç®¡ç†**: react-router-dom
- **è¡¨å•å¤„ç†**: react-hook-form + zod
- **æ•°æ®å¯è§†åŒ–**: recharts
- **åç«¯æœåŠ¡**: Supabase (PostgreSQL + Edge Functions)
- **æµ‹è¯•æ¡†æ¶**: Vitest + Playwright + Storybook

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18
- npm >= 8
- PostgreSQL >= 14 (é€šè¿‡Supabaseæä¾›)

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone [repository-url]
   cd Technical-Support-Management-Website
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **ç¯å¢ƒé…ç½®**
   ```bash
   cp .env.example .env
   ```
   ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å˜é‡ï¼š
   ```env
   VITE_SUPABASE_URL=your_supabase_url
   VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
   ```

4. **æ•°æ®åº“è¿ç§»**
   ```bash
   # æ‰§è¡Œæ•°æ®åº“è¿ç§»
   npm run db:migrate

   # æ’å…¥ç§å­æ•°æ®
   npm run db:seed
   ```

5. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

6. **è®¿é—®åº”ç”¨**
   æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:5173

## ğŸ“‹ NPM è„šæœ¬

### å¼€å‘ç›¸å…³
```bash
npm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run preview      # é¢„è§ˆæ„å»ºç»“æœ
npm run lint         # ä»£ç æ£€æŸ¥
npm run typecheck    # ç±»å‹æ£€æŸ¥
```

### æ•°æ®åº“ç›¸å…³
```bash
npm run db:migrate   # æ‰§è¡Œæ•°æ®åº“è¿ç§»
npm run db:seed      # æ’å…¥ç§å­æ•°æ®
npm run db:reset     # é‡ç½®æ•°æ®åº“ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
```

### æµ‹è¯•ç›¸å…³
```bash
npm run test:unit    # è¿è¡Œå•å…ƒæµ‹è¯•
npm run test:e2e     # è¿è¡ŒE2Eæµ‹è¯•
npm run test:coverage # æµ‹è¯•è¦†ç›–ç‡
npm run storybook    # å¯åŠ¨Storybook
```

##  éƒ¨ç½²åˆ° Vercel

### æ–¹æ³• 1: é€šè¿‡ Vercel CLI

```bash
npm install -g vercel
vercel
```

### æ–¹æ³• 2: é€šè¿‡ Git é›†æˆ

1. å°†ä»£ç æ¨é€åˆ° GitHub/GitLab/Bitbucket
2. åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡ (è§ä¸‹æ–¹)
4. éƒ¨ç½²

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡:

```
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

**é‡è¦**: å¦‚æœä¸é…ç½® Supabase,ç³»ç»Ÿå°†ä»¥æ¼”ç¤ºæ¨¡å¼è¿è¡Œ,ç¼–è¾‘åŠŸèƒ½åœ¨åˆ·æ–°åä¼šä¸¢å¤±ã€‚

##  æ•°æ®åº“é…ç½®

æœ¬é¡¹ç›®ä½¿ç”¨ Supabase ä½œä¸ºåç«¯æ•°æ®åº“ã€‚å®Œæ•´é…ç½®æŒ‡å—è¯·å‚è€ƒ:

 **[Supabase é…ç½®æŒ‡å—](./SUPABASE_SETUP.md)**

é…ç½®æ­¥éª¤æ¦‚è§ˆ:
1. åˆ›å»º Supabase é¡¹ç›®
2. æ‰§è¡Œ SQL è„šæœ¬åˆ›å»ºè¡¨ç»“æ„
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²åº”ç”¨

##  æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: React 18 + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **UI ç»„ä»¶**: shadcn/ui + Radix UI
- **æ ·å¼**: TailwindCSS
- **å›¾æ ‡**: Lucide React
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **éƒ¨ç½²**: Vercel

##  é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/        # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ui/           # UI åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DeviceDetail.tsx
â”‚   â”‚   â”œâ”€â”€ EditDeviceDialog.tsx
â”‚   â”‚   â”œâ”€â”€ HomePage.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ data/             # æ•°æ®æ¨¡å‹å’Œåˆå§‹æ•°æ®
â”‚   â”‚   â””â”€â”€ devices.ts
â”‚   â”œâ”€â”€ lib/              # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ supabase.ts   # Supabase å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ database.types.ts
â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â””â”€â”€ deviceService.ts
â”‚   â””â”€â”€ App.tsx           # åº”ç”¨å…¥å£
â”œâ”€â”€ SUPABASE_SETUP.md     # Supabase é…ç½®æŒ‡å—
â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ package.json
```

##  å¼€å‘è¯´æ˜

### æ·»åŠ æ–°è®¾å¤‡

åœ¨ Supabase Dashboard æˆ–é€šè¿‡åº”ç”¨ç•Œé¢æ·»åŠ ã€‚

### ä¿®æ”¹è®¾å¤‡ä¿¡æ¯

ç‚¹å‡»è®¾å¤‡å¡ç‰‡è¿›å…¥è¯¦æƒ…é¡µ,ç‚¹å‡»"ç¼–è¾‘è®¾å¤‡"æŒ‰é’®ã€‚

### æ·»åŠ ç»´æŠ¤è®°å½•

åœ¨è®¾å¤‡è¯¦æƒ…é¡µç‚¹å‡»"æ·»åŠ ç»´æŠ¤"æŒ‰é’®ã€‚

## ğŸ¯ å‚æ•°åŒ–è°ƒåº¦ç³»ç»Ÿ

å‚æ•°åŒ–è°ƒåº¦æ˜¯ä¸€ç§å£°æ˜å¼çš„è®¾å¤‡å’Œèµ„æºè°ƒåº¦æ–¹å¼ï¼Œé€šè¿‡é…ç½®å•ä¸€çš„è°ƒåº¦å‚æ•°ï¼ˆspecï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œæ‰€æœ‰ç›¸å…³çš„åŠ¨ä½œï¼Œè”åŠ¨æ›´æ–°èµ„äº§ä½ç½®ã€åº“å­˜å’Œç»‘å®šå…³ç³»ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å£°æ˜å¼é…ç½®**: åªéœ€é…ç½®"è¦è¾¾åˆ°çš„ç›®æ ‡çŠ¶æ€"ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºæ¯ä¸ªåŠ¨ä½œ
- **è‡ªåŠ¨å·®å¼‚è®¡ç®—**: ç³»ç»Ÿè‡ªåŠ¨æ¯”å¯¹å½“å‰çŠ¶æ€ä¸ç›®æ ‡çŠ¶æ€ï¼Œç”Ÿæˆå¿…è¦çš„åŠ¨ä½œ
- **äº‹åŠ¡åŒ–æ‰§è¡Œ**: æ‰€æœ‰åŠ¨ä½œåœ¨å•ä¸€äº‹åŠ¡ä¸­æ‰§è¡Œï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- **å¹‚ç­‰æ“ä½œ**: é‡å¤åº”ç”¨ç›¸åŒå‚æ•°ä¸ä¼šäº§ç”Ÿé‡å¤å‰¯ä½œç”¨
- **å¯å›æ»š**: æ”¯æŒä¸€é”®æ’¤é”€æ•´ä¸ªè°ƒåº¦å•çš„æ‰€æœ‰å½±å“

### ä½¿ç”¨åœºæ™¯

1. **è®¾å¤‡å¤–å‡º/æŠ•æ”¾**: å°†è®¾å¤‡ä»ä»“åº“è°ƒæ‹¨åˆ°å±•å…ï¼ŒåŒæ—¶æºå¸¦è€—æå’Œç»‘å®šç 
2. **è®¾å¤‡è½¬åœº**: æ›´æ”¹è®¾å¤‡ç›®çš„åœ°ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæ–°çš„è°ƒæ‹¨åŠ¨ä½œ
3. **è€—æè¡¥å……**: ä¿®æ”¹è€—ææ•°é‡ï¼Œç³»ç»Ÿè‡ªåŠ¨è°ƒæ•´é¢†ç”¨è®°å½•
4. **ç ç»‘å®šè°ƒæ•´**: æ›´æ¢æ‰“å°æœºæˆ–ç ï¼Œç³»ç»Ÿè‡ªåŠ¨éªŒè¯å…¼å®¹æ€§å¹¶æ›´æ–°ç»‘å®š

### å¿«é€Ÿå¼€å§‹

#### 1. åˆ›å»ºè°ƒåº¦å•

åœ¨è®¾å¤‡è¯¦æƒ…é¡µæˆ–åˆ—è¡¨é¡µç‚¹å‡»"å‚æ•°åŒ–è°ƒåº¦"æŒ‰é’®ï¼Œæ‰“å¼€è°ƒåº¦é…ç½®æŠ½å±‰ï¼š

```typescript
// è°ƒåº¦å‚æ•°ç¤ºä¾‹
{
  "destination_location_id": "å±•å…A",
  "source_location_id": "ä»“åº“",
  "items": [
    { "asset_type": "æ‰“å°æœº", "asset_id": "printer-001" },
    { "asset_type": "è·¯ç”±å™¨", "asset_id": "router-002" }
  ],
  "consumables": [
    { "consumable_id": "paper-6inch", "qty": 2 },
    { "consumable_id": "ribbon-dnp", "qty": 1 }
  ],
  "codes": [
    { "code_id": "code-ä¸“ç -001", "bind_to_printer_id": "printer-001" }
  ]
}
```

#### 2. ä¿å­˜è‰ç¨¿æˆ–ç›´æ¥åº”ç”¨

- **ä¿å­˜è‰ç¨¿**: ä»…ä¿å­˜é…ç½®ï¼Œä¸æ‰§è¡ŒåŠ¨ä½œ
- **ä¿å­˜å¹¶åº”ç”¨**: ç«‹å³æ‰§è¡Œï¼Œç”ŸæˆåŠ¨ä½œå¹¶æ›´æ–°æ•°æ®åº“

#### 3. ä¿®æ”¹å‚æ•°

ä¿®æ”¹ä»»æ„å‚æ•°åä¿å­˜ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
- è®¡ç®—ä¸ä¹‹å‰çŠ¶æ€çš„å·®å¼‚
- ç”Ÿæˆè¡¥å·®æˆ–å†²é”€åŠ¨ä½œ
- æ›´æ–°èµ„äº§ä½ç½®å’Œåº“å­˜

#### 4. æ’¤é”€è°ƒåº¦

å¦‚éœ€æ’¤é”€æ•´ä¸ªè°ƒåº¦å•çš„å½±å“ï¼š
- ç³»ç»ŸæŒ‰è®°å½•çš„ `dispatch_generated_actions` é€æ¡åå‘åŠ¨ä½œ
- åº“å­˜å’Œä½ç½®å›åˆ°è°ƒåº¦å‰çŠ¶æ€

### å…¼å®¹æ€§è§„åˆ™

ç³»ç»Ÿä¼šè‡ªåŠ¨éªŒè¯ä»¥ä¸‹å…¼å®¹æ€§è§„åˆ™ï¼š

| æ‰“å°æœºå“ç‰Œ | å…è®¸çš„ç ç±»å‹ | è¯´æ˜ |
|-----------|------------|------|
| DNP | ä»…ä¸“ç  | ä¸æ”¯æŒé€šç  |
| è¯šç ” | ä¸“ç /é€šç  | äºŒé€‰ä¸€ |
| è¥¿é“åŸ | ä¸“ç /é€šç  | äºŒé€‰ä¸€ |

- **ä¸“ç **: åªèƒ½ç»‘å®šåˆ°ä¸€å°æ‰“å°æœºï¼Œå·²ç»‘å®šåˆ™æŠ¥é”™
- **é€šç **: å¯å¤šæ¬¡ä½¿ç”¨

### æ•°æ®åº“è¡¨ç»“æ„

#### dispatch_orders (è°ƒåº¦å•è¡¨)
```sql
- id: UUID
- spec: JSONB (å”¯ä¸€å‚æ•°æº)
- status: ENUM (draft, applied, reverted)
- created_by, updated_by: TEXT
- effective_at: TIMESTAMPTZ
```

#### dispatch_generated_actions (ç”ŸæˆåŠ¨ä½œå…³è”è¡¨)
```sql
- dispatch_id: UUID (å¤–é”®)
- action_id: UUID (å¤–é”®)
- fingerprint: TEXT (å¹‚ç­‰é”®)
- operation: TEXT (add/revert)
```

### Edge Function

`apply_dispatch` Edge Function è´Ÿè´£ï¼š
1. è¯»å–è°ƒåº¦å•çš„ `spec`
2. æŸ¥è¯¢å½“å‰æ•°æ®åº“çŠ¶æ€
3. è®¡ç®—å·®å¼‚ï¼ˆdiffï¼‰
4. åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œæ–°å¢/æ’¤é”€åŠ¨ä½œ
5. æ›´æ–° `dispatch_orders.status`

### API ç¤ºä¾‹

```typescript
// åˆ›å»ºè°ƒåº¦å•
const id = await createDispatchOrder(spec, 'user-001', 'è®¾å¤‡å¤–å‡º-å±•å…A');

// æ›´æ–°è°ƒåº¦å•
await updateDispatchOrder(id, updatedSpec, 'user-001');

// åº”ç”¨è°ƒåº¦å•
const result = await applyDispatchOrder(id);
// result: { success: true, actions_added: 3, actions_reverted: 0 }

// æ’¤é”€è°ƒåº¦å•
await revertDispatchOrder(id, 'user-001');
```

### æœ€ä½³å®è·µ

1. **å…ˆè‰ç¨¿ååº”ç”¨**: å¤æ‚è°ƒåº¦å…ˆä¿å­˜è‰ç¨¿ï¼Œç¡®è®¤æ— è¯¯åå†åº”ç”¨
2. **åˆ†æ‰¹è°ƒåº¦**: å¤§æ‰¹é‡è®¾å¤‡åˆ†å¤šä¸ªè°ƒåº¦å•ï¼Œä¾¿äºè¿½è¸ªå’Œå›æ»š
3. **å¤‡æ³¨å®Œæ•´**: åœ¨ `notes` å­—æ®µè®°å½•è°ƒåº¦åŸå› å’Œç›®çš„
4. **å®šæœŸæ¸…ç†**: å·²å®Œæˆçš„è°ƒåº¦å•å¯å®šæœŸå½’æ¡£

##  åŸå§‹è®¾è®¡

This project is based on the Figma design: https://www.figma.com/design/pLarcIzb1aIELsn6Kwg8nw/%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E7%BD%91%E7%AB%99

##  License

MIT